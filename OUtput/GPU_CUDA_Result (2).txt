sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 32 1
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 594413 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 1 blocks, 32 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 594413
[594413] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (1, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.02
    gpu__time_duration.avg                                    msecond       967.00
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.23
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           64
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,730
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 32 4
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 594791 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 4 blocks, 32 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 594791
[594791] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (4, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.06
    gpu__time_duration.avg                                    msecond       284.66
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.93
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           64
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,736
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ^C
sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 32 16
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 596640 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 16 blocks, 32 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 596640
[596640] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (16, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.25
    gpu__time_duration.avg                                    msecond        72.97
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.70
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           64
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,760
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 32 64
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 596809 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 64 blocks, 32 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 596809
[596809] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (64, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.99
    gpu__time_duration.avg                                    msecond        18.46
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        14.79
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           64
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         1.56
    Achieved Active Warps Per SM           warp         1.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (1.6%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,856
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 32 256
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 596913 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 256 blocks, 32 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 596913
[596913] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (256, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         3.52
    gpu__time_duration.avg                                    msecond         5.18
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        59.19
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           64
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %         3.70
    Achieved Active Warps Per SM           warp         2.37
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 92.59%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (3.7%) can be the result of warp       
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,438,240
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 32 1024
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 597111 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 1024 blocks, 32 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 597111
[597111] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (1024, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        11.01
    gpu__time_duration.avg                                    msecond         1.66
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        99.27
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           64
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %        14.77
    Achieved Active Warps Per SM           warp         9.45
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 70.47%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (14.8%) can be the result of warp      
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,439,776
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 32 4096
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 597220 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 4096 blocks, 32 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 597220
[597220] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (4096, 1, 1)x(32, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        21.91
    gpu__time_duration.avg                                    usecond       934.40
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.86
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           64
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           64
    Theoretical Active Warps per SM        warp           32
    Theoretical Occupancy                     %           50
    Achieved Occupancy                        %        32.77
    Achieved Active Warps Per SM           warp        20.97
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 34.46%                                                                                     
          This kernel's theoretical occupancy (50.0%) is limited by the number of blocks that can fit on the SM. This   
          kernel's theoretical occupancy (50.0%) is limited by the required amount of shared memory. The difference     
          between calculated theoretical (50.0%) and measured achieved occupancy (32.8%) can be the result of warp      
          scheduling overheads or workload imbalances during the kernel execution. Load imbalances can occur between    
          warps within a block as well as across blocks of the same kernel. See the CUDA Best Practices Guide           
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,445,920
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 64 1
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 597338 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 1 blocks, 64 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 597338
[597338] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (1, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.04
    gpu__time_duration.avg                                    msecond       485.96
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.46
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           32
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,732
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 64 4
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 598057 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 4 blocks, 64 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 598057
[598057] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (4, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.12
    gpu__time_duration.avg                                    msecond       150.61
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         1.85
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           32
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,744
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 64 16
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 598764 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 16 blocks, 64 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 598764
[598764] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (16, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.44
    gpu__time_duration.avg                                    msecond        41.34
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         7.40
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           32
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,792
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 64 64
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 598820 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 64 blocks, 64 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 598820
[598820] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (64, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         1.87
    gpu__time_duration.avg                                    msecond         9.74
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        29.60
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           32
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         3.12
    Achieved Active Warps Per SM           warp         2.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 96.88%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (3.1%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,984
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 64 256
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 598903 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 256 blocks, 64 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 598903
[598903] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (256, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         6.08
    gpu__time_duration.avg                                    msecond         3.00
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        92.59
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           32
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         7.40
    Achieved Active Warps Per SM           warp         4.74
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 92.6%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (7.4%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,438,752
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 64 1024
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 598990 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 1024 blocks, 64 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 598990
[598990] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (1024, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        19.12
    gpu__time_duration.avg                                    usecond       955.33
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        98.02
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           32
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        29.06
    Achieved Active Warps Per SM           warp        18.60
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 70.94%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (29.1%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,441,824
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 64 4096
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599074 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 4096 blocks, 64 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599074
[599074] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (4096, 1, 1)x(64, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        34.99
    gpu__time_duration.avg                                    usecond       559.20
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.88
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           32
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           32
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        70.30
    Achieved Active Warps Per SM           warp        44.99
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 29.7%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (70.3%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,454,112
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 128 1
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599138 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 1 blocks, 128 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599138
[599138] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (1, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.07
    gpu__time_duration.avg                                    msecond       254.63
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.93
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           16
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,736
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 128 4
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599265 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 4 blocks, 128 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599265
[599265] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (4, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.22
    gpu__time_duration.avg                                    msecond        84.08
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.70
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           16
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,760
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 128 16
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599485 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 16 blocks, 128 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599485
[599485] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (16, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.88
    gpu__time_duration.avg                                    msecond        20.62
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        14.81
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           16
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,856
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 128 64
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599544 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 64 blocks, 128 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599544
[599544] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (64, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         3.52
    gpu__time_duration.avg                                    msecond         5.18
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        59.19
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           16
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %         6.25
    Achieved Active Warps Per SM           warp         4.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 93.75%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (6.2%) can be the result of warp scheduling overheads    
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,438,240
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 128 256
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599602 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 256 blocks, 128 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599602
[599602] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (256, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        11.09
    gpu__time_duration.avg                                    msecond         1.64
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        99.29
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           16
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        14.78
    Achieved Active Warps Per SM           warp         9.46
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 85.22%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (14.8%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,439,776
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 128 1024
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599662 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 1024 blocks, 128 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599662
[599662] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (1024, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        31.30
    gpu__time_duration.avg                                    usecond       603.23
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        97.69
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           16
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        54.83
    Achieved Active Warps Per SM           warp        35.09
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 45.17%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (54.8%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,445,920
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 128 4096
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599716 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 4096 blocks, 128 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%....50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599716
[599716] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (4096, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %        39.76
    gpu__time_duration.avg                                    usecond       476.45
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %        98.35
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block           16
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block           16
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        84.88
    Achieved Active Warps Per SM           warp        54.32
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 15.12%                                                                                     
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (84.9%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,470,496
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 256 1
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599776 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 1 blocks, 256 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599776
[599776] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (1, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.11
    gpu__time_duration.avg                                    msecond       171.91
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         0.93
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            8
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        12.50
    Achieved Active Warps Per SM           warp         8.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 87.5%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (12.5%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,744
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   

sicheng@nid001164:/pscratch/sd/s/sicheng/sobel-harness-instructional/build> ncu --set default --section SourceCounters --metrics smsp__cycles_active.avg.pct_of_peak_sustained_elapsed,dram__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.avg --section Occupancy --target-processes all ./sobel_gpu 256 4
 Read data from the file ../data/zebra-gray-int8-4x 
==PROF== Connected to process 599863 (/pscratch/sd/s/sicheng/sobel-harness-instructional/build/sobel_gpu)
 GPU configuration: 4 blocks, 256 threads per block 
==PROF== Profiling "sobel_kernel_gpu" - 0: 0%..
==WARNING== Launching the workload is taking more time than expected. If this continues to hang, terminate the profile and re-try by profiling the range of all related launches using '--replay-mode range'. See https://docs.nvidia.com/nsight-compute/ProfilingGuide/index.html#replay for more details.
..50%....100% - 5 passes
 Wrote the output file ../data/processed-raw-int8-4x-cpu.dat 
==PROF== Disconnected from process 599863
[599863] sobel_gpu@127.0.0.1
  sobel_kernel_gpu(float *, float *, int, int, int, float *, float *) (4, 1, 1)x(256, 1, 1), Context 1, Stream 7, Device 0, CC 8.0
    Section: Command line profiler metrics
    ----------------------------------------------------- ----------- ------------
    Metric Name                                           Metric Unit Metric Value
    ----------------------------------------------------- ----------- ------------
    dram__throughput.avg.pct_of_peak_sustained_elapsed              %         0.41
    gpu__time_duration.avg                                    msecond        44.60
    smsp__cycles_active.avg.pct_of_peak_sustained_elapsed           %         3.70
    ----------------------------------------------------- ----------- ------------

    Section: Occupancy
    ------------------------------- ----------- ------------
    Metric Name                     Metric Unit Metric Value
    ------------------------------- ----------- ------------
    Block Limit SM                        block           32
    Block Limit Registers                 block            8
    Block Limit Shared Mem                block           32
    Block Limit Warps                     block            8
    Theoretical Active Warps per SM        warp           64
    Theoretical Occupancy                     %          100
    Achieved Occupancy                        %        12.50
    Achieved Active Warps Per SM           warp         8.00
    ------------------------------- ----------- ------------

    OPT   Estimated Speedup: 87.5%                                                                                      
          This kernel's theoretical occupancy is not impacted by any block limit. The difference between calculated     
          theoretical (100.0%) and measured achieved occupancy (12.5%) can be the result of warp scheduling overheads   
          or workload imbalances during the kernel execution. Load imbalances can occur between warps within a block    
          as well as across blocks of the same kernel. See the CUDA Best Practices Guide                                
          (https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/index.html#occupancy) for more details on           
          optimizing occupancy.                                                                                         

    Section: Source Counters
    ------------------------- ----------- ------------
    Metric Name               Metric Unit Metric Value
    ------------------------- ----------- ------------
    Branch Instructions Ratio           %         0.02
    Branch Instructions              inst    3,437,792
    Branch Efficiency                   %        99.94
    Avg. Divergent Branches                       3.07
    ------------------------- ----------- ------------

    OPT   Estimated Speedup: 0%                                                                                         
          This kernel has uncoalesced global accesses resulting in a total of 6853584 excessive sectors (9% of the      
          total 73180108 sectors). Check the L2 Theoretical Sectors Global Excessive table for the primary source       
          locations. The CUDA Programming Guide                                                                         
          (https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses) had additional      
          information on reducing uncoalesced device memory accesses.                                                   


